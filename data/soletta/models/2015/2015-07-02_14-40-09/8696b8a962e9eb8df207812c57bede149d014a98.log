"2015-07-02 14:40:09 -0300"
diff --git a/Kconfig b/Kconfig
index 12d3cd95..3001c963 100644
--- a/Kconfig
+++ b/Kconfig
@@ -26,7 +26,6 @@ source "src/lib/datatypes/Kconfig"
 source "src/lib/flow/Kconfig"
 source "src/lib/io/Kconfig"
 source "src/lib/parsers/Kconfig"
-source "src/shared/Kconfig"
 endmenu
 
 menuconfig LINUX_MICRO
diff --git a/src/shared/Kconfig b/src/shared/Kconfig
deleted file mode 100644
index bbef2020..00000000
--- a/src/shared/Kconfig
+++ /dev/null
@@ -1,3 +0,0 @@
-config INTERNAL_SHARED
-	tristate
-	default m
diff --git a/src/shared/Makefile b/src/shared/Makefile
index 00f0279e..344f0868 100644
--- a/src/shared/Makefile
+++ b/src/shared/Makefile
@@ -1,7 +1,7 @@
-obj-$(INTERNAL_SHARED) += libshared.mod
+obj-m += libshared.mod
 obj-libshared-static := yes
 
-obj-libshared-$(INTERNAL_SHARED) := \
+obj-libshared-m := \
     sol-fbp-graph.o \
     sol-fbp-internal-log.o \
     sol-fbp-internal-scanner.o \
@@ -13,13 +13,6 @@ obj-libshared-m += \
     sol-fbp-parser.o
 endif
 
-ifeq (y,$(MODULES))
-obj-libshared-m += \
-    sol-conffile.o
-obj-libshared-m-extra-cflags += $(GLIB_CFLAGS)
-obj-libshared-m-extra-ldflags += $(GLIB_LDFLAGS)
-endif
-
 ifeq (y,$(PLATFORM_RIOTOS))
 obj-libshared-m += \
     sol-network-riot.o
@@ -27,6 +20,9 @@ endif
 
 ifeq (y,$(SOL_PLATFORM_LINUX))
 obj-libshared-m += \
+    sol-conffile.o \
     sol-file-reader.o \
     sol-network-linux.o
+obj-libshared-m-extra-cflags += $(GLIB_CFLAGS)
+obj-libshared-m-extra-ldflags += $(GLIB_LDFLAGS)
 endif
diff --git a/tools/build/Makefile.rules b/tools/build/Makefile.rules
index be288708..900a0188 100644
--- a/tools/build/Makefile.rules
+++ b/tools/build/Makefile.rules
@@ -42,7 +42,8 @@ parse-common-module = \
 	$(eval mod-objs     := $(filter %.o,$(artifacts))) \
 	$(eval $(1)-cflags  := $(obj-$(1)-$(3)-extra-cflags)) \
 	$(eval $(1)-ldflags := $(obj-$(1)-$(3)-extra-ldflags)) \
-	$(eval $(1)-bs      := $(addprefix $(2),Makefile Kconfig)) \
+	$(eval $(1)-bs      := $(addprefix $(2),Makefile)) \
+	$(eval $(1)-bs      += $(if $(wildcard $(2)/Kconfig),$(addprefix $(2),Kconfig))) \
 	$(eval $(1)-hdrs    := $(filter %.h,$(artifacts))) \
 	$(foreach obj,$(mod-objs), \
 		$(eval dest-obj        := $(subst $(top_srcdir)src/,$(build_stagedir),$(obj))) \