"2015-07-29 17:38:15 -0300"
diff --git a/src/lib/common/Kconfig b/src/lib/common/Kconfig
index d5a915f7..7b37b953 100644
--- a/src/lib/common/Kconfig
+++ b/src/lib/common/Kconfig
@@ -313,6 +313,10 @@ menu "Hardware Options"
 config USE_PWM
 	bool "PWM Support"
 	default y
+
+config USE_SPI
+	bool "SPI Support"
+	default y
 endmenu
 
 
diff --git a/src/lib/io/Makefile b/src/lib/io/Makefile
index 798fd5e8..5c8c5202 100644
--- a/src/lib/io/Makefile
+++ b/src/lib/io/Makefile
@@ -13,13 +13,17 @@ ifeq (y,$(PLATFORM_RIOTOS))
 obj-io-$(IO) += \
     sol-gpio-riot.o \
     sol-i2c-riot.o \
-    sol-spi-riot.o \
     sol-uart-riot.o
 
 ifeq (y, $(USE_PWM))
 obj-io-$(IO) += \
     sol-pwm-riot.o
 endif # USE_PWM
+
+ifeq (y, $(USE_SPI))
+obj-io-$(IO) += \
+    sol-spi-riot.o
+endif # USE_SPI
 endif
 
 ifeq (y,$(PLATFORM_CONTIKI))
@@ -31,22 +35,30 @@ ifeq (y,$(SOL_PLATFORM_LINUX))
 obj-io-$(IO) += \
     sol-gpio-linux.o \
     sol-i2c-linux.o \
-    sol-spi-linux.o \
     sol-uart-linux.o
 
 ifeq (y, $(USE_PWM))
 obj-io-$(IO) += \
     sol-pwm-linux.o
 endif # USE_PWM
+
+ifeq (y, $(USE_SPI))
+obj-io-$(IO) += \
+    sol-spi-linux.o
+endif # USE_SPI
 endif
 
 headers-$(IO) := \
     include/sol-gpio.h \
     include/sol-i2c.h \
-    include/sol-spi.h \
     include/sol-uart.h
 
 ifeq (y, $(USE_PWM))
 headers-$(IO) += \
     include/sol-pwm.h
 endif
+
+ifeq (y, $(USE_SPI))
+headers-$(IO) += \
+    include/sol-spi.h
+endif
diff --git a/src/modules/flow/calamari/Kconfig b/src/modules/flow/calamari/Kconfig
index 68582d9c..9b2b5439 100644
--- a/src/modules/flow/calamari/Kconfig
+++ b/src/modules/flow/calamari/Kconfig
@@ -1,4 +1,4 @@
 config FLOW_NODE_TYPE_CALAMARI
 	tristate "Node type: calamari"
-	depends on FLOW && (FLOW_NODE_TYPE_GPIO = y) && USE_PWM
+	depends on FLOW && (FLOW_NODE_TYPE_GPIO = y) && USE_PWM && USE_SPI
 	default m
diff --git a/src/modules/flow/led-strip/Kconfig b/src/modules/flow/led-strip/Kconfig
index eff509b0..bd99544b 100644
--- a/src/modules/flow/led-strip/Kconfig
+++ b/src/modules/flow/led-strip/Kconfig
@@ -1,4 +1,4 @@
 config FLOW_NODE_TYPE_LED_STRIP
 	tristate "Node type: led-strip"
-	depends on FLOW
+	depends on FLOW && USE_SPI
 	default m