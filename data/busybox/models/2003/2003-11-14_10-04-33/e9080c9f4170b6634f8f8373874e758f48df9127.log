"2003-11-14 10:04:33 +0000"
diff --git a/debianutils/Config.in b/debianutils/Config.in
index 6534cc7e8..399ccae6b 100644
--- a/debianutils/Config.in
+++ b/debianutils/Config.in
@@ -11,6 +11,12 @@ config CONFIG_MKTEMP
 	help
 	  mktemp is used to create unique temporary files
 
+config CONFIG_PIPE_PROGRESS
+	bool "pipe_progress"
+	default n
+	help
+	  Display a dot to indicate pipe activity.
+
 config CONFIG_READLINK
 	bool "readlink"
 	default n
diff --git a/debianutils/Makefile.in b/debianutils/Makefile.in
index 8ca05c738..46530174f 100644
--- a/debianutils/Makefile.in
+++ b/debianutils/Makefile.in
@@ -25,6 +25,7 @@ endif
 
 DEBIANUTILS-y:=
 DEBIANUTILS-$(CONFIG_MKTEMP)		+= mktemp.o
+DEBIANUTILS-$(CONFIG_PIPE_PROGRESS)	+= pipe_progress.o
 DEBIANUTILS-$(CONFIG_READLINK)		+= readlink.o
 DEBIANUTILS-$(CONFIG_RUN_PARTS)		+= run_parts.o
 DEBIANUTILS-$(CONFIG_START_STOP_DAEMON)	+= start_stop_daemon.o
diff --git a/debianutils/pipe_progress.c b/debianutils/pipe_progress.c
new file mode 100644
index 000000000..81ce395c9
--- /dev/null
+++ b/debianutils/pipe_progress.c
@@ -0,0 +1,54 @@
+/*
+ * Monitor a pipe with a simple progress display.
+ *
+ * Copyright (C) 2003 by Rob Landley <rob@landley.net>, Joey Hess
+ *
+ * This program is free software; you can redistribute it and/or modify
+ * it under the terms of the GNU General Public License as published by
+ * the Free Software Foundation; either version 2 of the License, or
+ * (at your option) any later version.
+ *
+ * This program is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU
+ * General Public License for more details.
+ *
+ * You should have received a copy of the GNU General Public License
+ * along with this program; if not, write to the Free Software
+ * Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA 02111-1307 USA
+ *
+ */
+
+#include <stdio.h>
+#include <unistd.h>
+#include <time.h>
+
+#include "busybox.h"
+
+#define PIPE_PROGRESS_SIZE 4096
+
+/*	Read a block of data from stdin, write it to stdout.
+ *  Activity is indicated by a '.' to stderr
+ */
+extern int pipe_progress_main(int argc, char **argv)
+{
+	RESERVE_CONFIG_BUFFER(buf, PIPE_PROGRESS_SIZE);
+	time_t t = time(NULL);
+	size_t len;
+
+	while ((len = fread(buf, 1, PIPE_PROGRESS_SIZE, stdin)) > 0) {
+		time_t new_time = time(NULL);
+		if (new_time != t) {
+			t = new_time;
+			fputc('.', stderr);
+		}
+		fwrite(buf, len, 1, stdout);
+	}
+
+	fputc('\n', stderr);
+
+#ifdef CONFIG_FEATURE_CLEAN_UP
+	RELEASE_CONFIG_BUFFER(buf);
+#endif
+	return 0;
+}
diff --git a/include/applets.h b/include/applets.h
index 6f1295a30..5449777b1 100644
--- a/include/applets.h
+++ b/include/applets.h
@@ -448,6 +448,9 @@
 #ifdef CONFIG_PING6
 	APPLET(ping6, ping6_main, _BB_DIR_BIN, _BB_SUID_NEVER)
 #endif
+#ifdef CONFIG_PIPE_PROGRESS
+	APPLET_NOUSAGE("pipe_progress", pipe_progress_main, _BB_DIR_BIN, _BB_SUID_NEVER)
+#endif
 #ifdef CONFIG_PIVOT_ROOT
  	APPLET(pivot_root, pivot_root_main, _BB_DIR_SBIN, _BB_SUID_NEVER)
 #endif