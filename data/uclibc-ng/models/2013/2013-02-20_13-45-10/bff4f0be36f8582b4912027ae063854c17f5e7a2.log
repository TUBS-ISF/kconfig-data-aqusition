"2013-02-20 13:45:10 +0100"
diff --git a/extra/Configs/Config.alpha b/extra/Configs/Config.alpha
index 144924a65..212df6a82 100644
--- a/extra/Configs/Config.alpha
+++ b/extra/Configs/Config.alpha
@@ -13,4 +13,5 @@ config FORCE_OPTIONS_FOR_ARCH
 	select ARCH_LITTLE_ENDIAN
 	select ARCH_HAS_MMU
 	select ARCH_HAS_NO_LDSO
+	select ARCH_HAS_DEPRECATED_SYSCALLS
 	select UCLIBC_HAS_LFS
diff --git a/extra/Configs/Config.arm b/extra/Configs/Config.arm
index dc536434d..a16c9197a 100644
--- a/extra/Configs/Config.arm
+++ b/extra/Configs/Config.arm
@@ -12,6 +12,7 @@ config FORCE_OPTIONS_FOR_ARCH
 	default y
 	select ARCH_ANY_ENDIAN
 	select ARCH_HAS_UCONTEXT
+	select ARCH_HAS_DEPRECATED_SYSCALLS
 
 config CONFIG_ARM_EABI
 	bool "Build for EABI"
diff --git a/extra/Configs/Config.avr32 b/extra/Configs/Config.avr32
index cbadb4cf5..5fcd6f216 100644
--- a/extra/Configs/Config.avr32
+++ b/extra/Configs/Config.avr32
@@ -11,6 +11,7 @@ config FORCE_OPTIONS_FOR_ARCH
 	bool
 	default y
 	select ARCH_BIG_ENDIAN
+	select ARCH_HAS_DEPRECATED_SYSCALLS
 	select FORCE_SHAREABLE_TEXT_SEGMENTS
 
 choice
diff --git a/extra/Configs/Config.bfin b/extra/Configs/Config.bfin
index a70afcfd8..c3ed1716c 100644
--- a/extra/Configs/Config.bfin
+++ b/extra/Configs/Config.bfin
@@ -12,3 +12,4 @@ config FORCE_OPTIONS_FOR_ARCH
 	default y
 	select ARCH_LITTLE_ENDIAN
 	select ARCH_HAS_NO_MMU
+	select ARCH_HAS_DEPRECATED_SYSCALLS
diff --git a/extra/Configs/Config.cris b/extra/Configs/Config.cris
index 52ca0c36b..c49817f65 100644
--- a/extra/Configs/Config.cris
+++ b/extra/Configs/Config.cris
@@ -11,6 +11,7 @@ config FORCE_OPTIONS_FOR_ARCH
 	bool
 	default y
 	select ARCH_LITTLE_ENDIAN
+	select ARCH_HAS_DEPRECATED_SYSCALLS
 
 choice
 	prompt "Target Architecture Type"
diff --git a/extra/Configs/Config.e1 b/extra/Configs/Config.e1
index ecaa9f0e5..284bbfaee 100644
--- a/extra/Configs/Config.e1
+++ b/extra/Configs/Config.e1
@@ -13,3 +13,4 @@ config FORCE_OPTIONS_FOR_ARCH
 	select ARCH_BIG_ENDIAN
 	select ARCH_HAS_NO_MMU
 	select ARCH_HAS_NO_SHARED
+	select ARCH_HAS_DEPRECATED_SYSCALLS
diff --git a/extra/Configs/Config.frv b/extra/Configs/Config.frv
index b389870f9..d7eeaf90e 100644
--- a/extra/Configs/Config.frv
+++ b/extra/Configs/Config.frv
@@ -13,3 +13,4 @@ config FORCE_OPTIONS_FOR_ARCH
 	select ARCH_BIG_ENDIAN
 	select UCLIBC_HAS_FPU
 	select ARCH_HAS_NO_MMU
+	select ARCH_HAS_DEPRECATED_SYSCALLS
diff --git a/extra/Configs/Config.h8300 b/extra/Configs/Config.h8300
index ffcb9c837..458851b28 100644
--- a/extra/Configs/Config.h8300
+++ b/extra/Configs/Config.h8300
@@ -12,6 +12,7 @@ config FORCE_OPTIONS_FOR_ARCH
 	default y
 	select ARCH_ANY_ENDIAN
 	select ARCH_HAS_NO_MMU
+	select ARCH_HAS_DEPRECATED_SYSCALLS
 
 choice
 	prompt "Target Processor"
diff --git a/extra/Configs/Config.hppa b/extra/Configs/Config.hppa
index 1323de228..938e2e35b 100644
--- a/extra/Configs/Config.hppa
+++ b/extra/Configs/Config.hppa
@@ -15,3 +15,4 @@ config FORCE_OPTIONS_FOR_ARCH
 	select HAS_NO_THREADS
 	select ARCH_HAS_NO_LDSO
 	select HAVE_NO_SSP
+	select ARCH_HAS_DEPRECATED_SYSCALLS
diff --git a/extra/Configs/Config.i386 b/extra/Configs/Config.i386
index 92cee3b83..63383ced2 100644
--- a/extra/Configs/Config.i386
+++ b/extra/Configs/Config.i386
@@ -13,6 +13,7 @@ config FORCE_OPTIONS_FOR_ARCH
 	select ARCH_LITTLE_ENDIAN
 	select ARCH_HAS_MMU
 	select ARCH_HAS_UCONTEXT
+	select ARCH_HAS_DEPRECATED_SYSCALLS
 
 choice
 	prompt "Target x86 Processor Family"
diff --git a/extra/Configs/Config.i960 b/extra/Configs/Config.i960
index 798dae0c2..bf937ab08 100644
--- a/extra/Configs/Config.i960
+++ b/extra/Configs/Config.i960
@@ -13,3 +13,4 @@ config FORCE_OPTIONS_FOR_ARCH
 	select ARCH_LITTLE_ENDIAN
 	select ARCH_HAS_NO_MMU
 	select HAS_NO_THREADS
+	select ARCH_HAS_DEPRECATED_SYSCALLS
diff --git a/extra/Configs/Config.ia64 b/extra/Configs/Config.ia64
index ae88be777..983b3ee54 100644
--- a/extra/Configs/Config.ia64
+++ b/extra/Configs/Config.ia64
@@ -13,3 +13,4 @@ config FORCE_OPTIONS_FOR_ARCH
 	select ARCH_LITTLE_ENDIAN
 	select ARCH_HAS_MMU
 	select ARCH_HAS_NO_LDSO
+	select ARCH_HAS_DEPRECATED_SYSCALLS
diff --git a/extra/Configs/Config.in b/extra/Configs/Config.in
index 344409f6a..bad8cf16e 100644
--- a/extra/Configs/Config.in
+++ b/extra/Configs/Config.in
@@ -490,6 +490,7 @@ config HAS_NO_THREADS
 
 config LINUXTHREADS_OLD
 	bool "older (stable) version of linuxthreads"
+	depends on ARCH_HAS_DEPRECATED_SYSCALLS
 	# linuxthreads and linuxthreads.old need nanosleep()
 	select UCLIBC_HAS_REALTIME
 	help
@@ -500,6 +501,7 @@ config LINUXTHREADS_OLD
 
 config LINUXTHREADS_NEW
 	bool "slightly newer version of linuxthreads"
+	depends on ARCH_HAS_DEPRECATED_SYSCALLS
 	help
 	  The new version has not been tested much, and lacks ports for arches
 	  which glibc does not support (like bfin/frv/etc...), but is based on
diff --git a/extra/Configs/Config.in.arch b/extra/Configs/Config.in.arch
index 6d93433dc..2338e3cb3 100644
--- a/extra/Configs/Config.in.arch
+++ b/extra/Configs/Config.in.arch
@@ -39,6 +39,14 @@ if ARCH_USE_MMU
 comment "Using ELF file format"
 endif
 
+config ARCH_HAS_DEPRECATED_SYSCALLS
+	bool
+	help
+	  New architectures do not support deprecated system calls. However,
+	  these system calls are needed to build linuxthreads (old and new) so
+	  this symbol controls whether there is support for these threading libraries
+	  or not.
+
 config UCLIBC_SHARED_FLAT_ID
 	int "Shared library ID"
 	default 1
diff --git a/extra/Configs/Config.m68k b/extra/Configs/Config.m68k
index 95807c485..5888067bc 100644
--- a/extra/Configs/Config.m68k
+++ b/extra/Configs/Config.m68k
@@ -11,3 +11,4 @@ config FORCE_OPTIONS_FOR_ARCH
 	bool
 	default y
 	select ARCH_BIG_ENDIAN
+	select ARCH_HAS_DEPRECATED_SYSCALLS
diff --git a/extra/Configs/Config.microblaze b/extra/Configs/Config.microblaze
index 2dfd4a703..fddc5d6e5 100644
--- a/extra/Configs/Config.microblaze
+++ b/extra/Configs/Config.microblaze
@@ -6,3 +6,8 @@
 config TARGET_ARCH
 	string
 	default "microblaze"
+
+config FORCE_OPTIONS_FOR_ARCH
+	bool
+	default y
+	select ARCH_HAS_DEPRECATED_SYSCALLS
diff --git a/extra/Configs/Config.mips b/extra/Configs/Config.mips
index 48e0b6489..1f8426556 100644
--- a/extra/Configs/Config.mips
+++ b/extra/Configs/Config.mips
@@ -12,6 +12,7 @@ config FORCE_OPTIONS_FOR_ARCH
 	default y
 	select ARCH_ANY_ENDIAN
 	select ARCH_HAS_UCONTEXT
+	select ARCH_HAS_DEPRECATED_SYSCALLS
 
 choice
 	prompt "Target ABI"
diff --git a/extra/Configs/Config.nios b/extra/Configs/Config.nios
index 4213a4cf8..639cd35e2 100644
--- a/extra/Configs/Config.nios
+++ b/extra/Configs/Config.nios
@@ -13,4 +13,5 @@ config FORCE_OPTIONS_FOR_ARCH
 	select ARCH_LITTLE_ENDIAN
 	select ARCH_HAS_NO_MMU
 	select ARCH_HAS_NO_LDSO
+	select ARCH_HAS_DEPRECATED_SYSCALLS
 	select HAVE_NO_PIC
diff --git a/extra/Configs/Config.nios2 b/extra/Configs/Config.nios2
index 2310a46c0..8bb8aca49 100644
--- a/extra/Configs/Config.nios2
+++ b/extra/Configs/Config.nios2
@@ -13,4 +13,5 @@ config FORCE_OPTIONS_FOR_ARCH
 	select ARCH_LITTLE_ENDIAN
 	select ARCH_HAS_NO_MMU
 	select ARCH_HAS_NO_LDSO
+	select ARCH_HAS_DEPRECATED_SYSCALLS
 	select HAVE_NO_PIC
diff --git a/extra/Configs/Config.powerpc b/extra/Configs/Config.powerpc
index 84c442329..7698022ae 100644
--- a/extra/Configs/Config.powerpc
+++ b/extra/Configs/Config.powerpc
@@ -12,6 +12,7 @@ config FORCE_OPTIONS_FOR_ARCH
 	default y
 	select ARCH_BIG_ENDIAN
 	select ARCH_HAS_MMU
+	select ARCH_HAS_DEPRECATED_SYSCALLS
 
 choice
 	prompt "Target Processor Type"
diff --git a/extra/Configs/Config.sh b/extra/Configs/Config.sh
index 6ce54c265..5e0fc9e1c 100644
--- a/extra/Configs/Config.sh
+++ b/extra/Configs/Config.sh
@@ -11,6 +11,7 @@ config FORCE_OPTIONS_FOR_ARCH
 	bool
 	default y
 	select ARCH_ANY_ENDIAN
+	select ARCH_HAS_DEPRECATED_SYSCALLS
 
 choice
 	prompt "Target Processor Type"
diff --git a/extra/Configs/Config.sh64 b/extra/Configs/Config.sh64
index 02535b96b..a617510ac 100644
--- a/extra/Configs/Config.sh64
+++ b/extra/Configs/Config.sh64
@@ -11,6 +11,7 @@ config FORCE_OPTIONS_FOR_ARCH
 	bool
 	default y
 	select ARCH_ANY_ENDIAN
+	select ARCH_HAS_DEPRECATED_SYSCALLS
 
 choice
 	prompt "Target Processor Type"
diff --git a/extra/Configs/Config.sparc b/extra/Configs/Config.sparc
index 1852efee9..c6180c831 100644
--- a/extra/Configs/Config.sparc
+++ b/extra/Configs/Config.sparc
@@ -11,6 +11,7 @@ config FORCE_OPTIONS_FOR_ARCH
 	bool
 	default y
 	select ARCH_BIG_ENDIAN
+	select ARCH_HAS_DEPRECATED_SYSCALLS
 
 choice
 	prompt "Target Processor Type"
diff --git a/extra/Configs/Config.v850 b/extra/Configs/Config.v850
index fb3c4b144..82d8be0b5 100644
--- a/extra/Configs/Config.v850
+++ b/extra/Configs/Config.v850
@@ -12,4 +12,5 @@ config FORCE_OPTIONS_FOR_ARCH
 	default y
 	select ARCH_LITTLE_ENDIAN
 	select ARCH_HAS_NO_MMU
+	select ARCH_HAS_DEPRECATED_SYSCALLS
 	select HAVE_NO_PIC
diff --git a/extra/Configs/Config.vax b/extra/Configs/Config.vax
index 989eeeab5..418e3e71c 100644
--- a/extra/Configs/Config.vax
+++ b/extra/Configs/Config.vax
@@ -12,3 +12,4 @@ config FORCE_OPTIONS_FOR_ARCH
 	default y
 	select ARCH_LITTLE_ENDIAN
 	select ARCH_HAS_NO_LDSO
+	select ARCH_HAS_DEPRECATED_SYSCALLS
diff --git a/extra/Configs/Config.x86_64 b/extra/Configs/Config.x86_64
index 4c8c3a9bd..317a5007f 100644
--- a/extra/Configs/Config.x86_64
+++ b/extra/Configs/Config.x86_64
@@ -13,3 +13,4 @@ config FORCE_OPTIONS_FOR_ARCH
 	select ARCH_LITTLE_ENDIAN
 	select ARCH_HAS_MMU
 	select ARCH_HAS_UCONTEXT
+	select ARCH_HAS_DEPRECATED_SYSCALLS
diff --git a/extra/Configs/Config.xtensa b/extra/Configs/Config.xtensa
index d374f91bc..5448e5155 100644
--- a/extra/Configs/Config.xtensa
+++ b/extra/Configs/Config.xtensa
@@ -6,3 +6,8 @@
 config TARGET_ARCH
 	string
 	default "xtensa"
+
+config FORCE_OPTIONS_FOR_ARCH
+	bool
+	default y
+	select ARCH_HAS_DEPRECATED_SYSCALLS