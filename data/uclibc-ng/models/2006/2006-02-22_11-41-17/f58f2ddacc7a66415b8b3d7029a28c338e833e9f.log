"2006-02-22 11:41:17 +0000"
diff --git a/Rules.mak b/Rules.mak
index a3a1b5f50..15f900fe6 100644
--- a/Rules.mak
+++ b/Rules.mak
@@ -355,12 +355,15 @@ endif
 
 LDFLAGS:=$(LDFLAGS_NOSTRIP) -z defs
 ifeq ($(DODEBUG),y)
-    #CFLAGS += -g3
-    CFLAGS += -O0 -g3
-    STRIPTOOL:= true -Since_we_are_debugging
+#CFLAGS += -g3
+CFLAGS += -O0 -g3
 else
-    CFLAGS += $(OPTIMIZATION) $(XARCH_CFLAGS)
-    LDFLAGS += -s
+CFLAGS += $(OPTIMIZATION) $(XARCH_CFLAGS)
+endif
+ifeq ($(NOSTRIP),y)
+STRIPTOOL := true -Stripping_disabled
+else
+LDFLAGS += -s
 endif
 
 ifeq ($(DOMULTI),y)
diff --git a/extra/Configs/Config.in b/extra/Configs/Config.in
index 9658639a1..291a2b633 100644
--- a/extra/Configs/Config.in
+++ b/extra/Configs/Config.in
@@ -1357,6 +1357,7 @@ config CROSS_COMPILER_PREFIX
 config DODEBUG
 	bool "Build uClibc with debugging symbols"
 	default n
+	select NOSTRIP
 	help
 	  Say Y here if you wish to compile uClibc with debugging symbols.
 	  This will allow you to use a debugger to examine uClibc internals
@@ -1376,6 +1377,14 @@ config DODEBUG_PT
 
 	  Otherwise, answer N.
 
+config NOSTRIP
+	bool "Do not build stripped libraries and executables"
+	default n
+	help
+	  Say Y here if you do not wish to strip all uClibc libraries and
+	  executables.  This increases the size of the binaries considerably.
+	  Most people will answer N.
+
 config DOASSERTS
 	bool "Build uClibc with run-time assertion testing"
 	default n
diff --git a/libpthread/linuxthreads.old_db/Makefile.in b/libpthread/linuxthreads.old_db/Makefile.in
index d01db5168..1af0389db 100644
--- a/libpthread/linuxthreads.old_db/Makefile.in
+++ b/libpthread/linuxthreads.old_db/Makefile.in
@@ -8,7 +8,10 @@
 # Get the thread include dependencies and shared object name
 CFLAGS-linuxthreads.old_db := -DNOT_IN_libc -DLIBPTHREAD_SO="\"libpthread.so.$(MAJOR_VERSION)\""
 
-LDFLAGS-libthread_db.so := $(LDFLAGS_NOSTRIP) -s $(call check_ld,--warn-unresolved-symbols)
+LDFLAGS-libthread_db.so := $(LDFLAGS_NOSTRIP) $(call check_ld,--warn-unresolved-symbols)
+ifneq ($(NOSTRIP),y)
+LDFLAGS-libthread_db.so += -s
+endif
 
 LIBS-libthread_db.so := $(LIBS)
 
diff --git a/libpthread/linuxthreads_db/Makefile.in b/libpthread/linuxthreads_db/Makefile.in
index 06106e8af..3d179a402 100644
--- a/libpthread/linuxthreads_db/Makefile.in
+++ b/libpthread/linuxthreads_db/Makefile.in
@@ -8,7 +8,10 @@
 # Get the thread include dependencies and shared object name
 CFLAGS-linuxthreads_db := -DNOT_IN_libc -DLIBPTHREAD_SO="\"libpthread.so.$(MAJOR_VERSION)\""
 
-LDFLAGS-libthread_db.so := $(LDFLAGS_NOSTRIP) -s $(call check_ld,--warn-unresolved-symbols)
+LDFLAGS-libthread_db.so := $(LDFLAGS_NOSTRIP) $(call check_ld,--warn-unresolved-symbols)
+ifneq ($(NOSTRIP),y)
+LDFLAGS-libthread_db.so += -s
+endif
 
 LIBS-libthread_db.so := $(LIBS)
 